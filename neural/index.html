<!-- Include D3.js -->
<script src="/src/d3.v7.js"></script>
<!-- Container for visualization -->
<div id="network-viz"></div>

<div id="toolbar">
    <input type="file" id="nr-upload" accept=".nr">
    <button onclick="loadModel()">Visualize</button>
</div>

<script>
function loadModel() {
    const file = document.getElementById('nr-upload').files[0];
    const reader = new FileReader();
    
    reader.onload = function(e) {
        const nrContent = e.target.result;
        // Send to parser endpoint
        d3.json("/parse").then(data => {
            const simulation = d3.forceSimulation(data.nodes)
            .force("link", d3.forceLink(data.links).id(d => d.id))
            .force("charge", d3.forceManyBody().strength(-1000))
            .force("center", d3.forceCenter(width/2, height/2));

        node.append("title") // Tooltip
            .text(d => `${d.type}\nParams: ${d.params}`);

        node.call(d3.drag() // Dragging
            .on("start", dragstarted)
            .on("drag", dragged)
            .on("end", dragended));
        });
    
    reader.readAsText(file);
    }

}
</script>